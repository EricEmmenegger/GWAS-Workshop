---
title: "NA Removal from GWAS Results"
output: html_notebook
---

*This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code.*

*Try executing this chunk by clicking the Run button within the chunk or by placing your cursor inside it and pressing Ctrl+Shift+Enter.* 

### Steps

First emove NA values from GWAS results, as further plots may not work otherwise. Generate a data table of the 50 SNPs with lowest p-value in ascending order.

```{r}
results <- read.table("GWAS_results.assoc.linear",  
                      header = TRUE, 
                      sep = "", 
                      fill = TRUE, 
                      quote = "", 
                      check.names = FALSE)

NA_removed <- as.data.frame( na.omit(results))

write.table(NA_removed, 
            "GWAS_results_na_removed.assoc.linear", 
            append=FALSE, 
            sep='\t', 
            row.names=FALSE, 
            col.names=TRUE, 
            quote=FALSE)
```

Sort the rows of the NA_removed data table by increasing p-value. Get rows corresponding to the SNPs with the lowest p-value.

```{r}
sorted <- NA_removed[order(NA_removed$"P"),]

top50 <- sorted[1:50,]

write.table(NA_removed, 
            "GWAS_results_top50_SNPs.assoc.linear", 
            append=FALSE, 
            sep='\t', 
            row.names=FALSE, 
            col.names=TRUE, 
            quote=FALSE)
```




### Default R Notebook Instructions


Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
